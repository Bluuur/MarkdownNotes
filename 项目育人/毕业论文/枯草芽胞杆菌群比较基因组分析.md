# 枯草芽胞杆菌群比较基因组分析

[toc]



## 材料与方法

### 材料

#### 枯草芽孢杆菌参考基因组

*Bacillus subtilis*

https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_000009045.1/

### 方法

#### 基因组组分分析

##### [Glimmer](http://ccb.jhu.edu/software/glimmer/index.shtml)	预测基因组编码基因

+ Glimmer 安装

```bash
wget http://www.cbcb.umd.edu/software/glimmer/glimmer302.tar.gz

tar -zxvf glimmer302.tar.gz  # 解压缩命令
# tar -zcvf 压缩文件名.tar.gz 被压缩文件名
cd glimmer3.02/src
make # 编译
# 将 glimmer 的 bin 目录添加环境变量
echo export PATH=~/glimmer3.02/bin:\$PATH >>  ~/.bashrc 
```

+ 预测基因组编码基因

```bash
# 选用自身作为训练集来作为模型
# 运行 long-orfs 产生无重叠的 orfs
long-orfs -n -t 1.15 ~/seq/ZW.fa ~/result/glimmer_out/ZW.longorfs  1>/dev/null 2>/dev/null
# 运行 extract 提取训练集
extract -t ~/seq/ZW.fa ~/result/glimmer_out/ZW.longorfs  > ~/result/glimmer_out/ZW.train  2>/dev/null
# 运行 bulid-icm 通过训练集，生产预测的模型，用于基因预测
build-icm  -r ~/result/glimmer_out/ZW.icm < ~/result/glimmer_out/ZW.train 1>/dev/null 2>/dev/null
# 运行 glimmer3 完成基因预测
glimmer3 -o50 -g110 -t30 ~/seq/ZW.fa ~/result/glimmer_out/ZW.icm ZW
# 参数含义：
# -o50 指定 ORF 被视为基因预测的最小长度
# -g110 指定 ORF 被视为基因预测的最大长度
# -t30 指定基因预测的最小分数阈值，该分数基于 ORF 的各种特征（如起始密码子上下文、编码潜力等）计算而来
```



##### [tRNAscan-SE](http://topaz.gatech.edu/GeneMark)	预测 tRNA

使用 conda 安装

```bash
# 安装 conda 环境
# 下载 Miniconda 安装脚本
wget https://repo.anaconda.com/miniconda/Miniconda3-py37_4.10.3-Linux-x86_64.sh 
# 运行安装脚本
bash Miniconda3-latest-Linux-x86_64.sh
# 刷新环境变量
source .bashrc
# 安装 tRNAscan-SE
conda install trnascan-se -c bioconda
# 使用前需要将依赖程序链接到指定的目录
cp ~/miniconda3/pkg/trnascan-se-2.0.6-pl526h516909a_0/bin/tRNAscan-SE.conf ./
```

+ [rRNAmmer](http://trna.ucsc.edu/software/)	分析 rRNA
+ [BLAST+](ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.3.0/)	预测 SnRNA
+ [Minced](https://github.com/ctSkennerton/minced)	预测 CRISPR-Cas 数量
+ [PHAST](https://sourceforge.net/projects/phage-finder/files/)	预测前噬菌体个数
+ [IslandViewer](https://www.pathogenomics.sfu.ca/islandviewer/resources/)	预测基因岛数量

#### 基因功能分析

+ [Blast2go](https://www.blast2go.com/)	GO 数据库注释
+ [eggNOG](http://eggnogdb.embl.de/#/app/home)	COG 数据库注释
+ [KEGG 在线数据库](http://www.genome.jp/kegg/)	KEGG 注释
+ [CAZy](http://www.cazy.org/)	CAZy 注释
+ [antiSMASH](https://dl.secondarymetabolites.org/releases/4.0.2/)	次级代谢产物注释

#### 比较基因组分析

+ [IQ-TREE](http://www.iqtree.org/release/v1.6.12)	构建同源单拷贝基因系统发育树，建树方法为 maximum likelihood
+ [Mummer](https://mummer4.github.io/)	共线性分析，默认软件参数