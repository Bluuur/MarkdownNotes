# **出芽酵母单核苷酸突变特征**

## 成员与分工

+ 生信 2001 张子栋
  + 代码实现
  + 项目展示
  + 实验报告书
+ 生信 2002 梁国相
  + 思路与模型建立
  + 代码校对
  + R 语言绘图

# 报告内容

## 实验思路

使用 Java 通过 MyBatis 操作数据库，完成统计量计算；再通过 R 绘图。

## 数据预处理

### 数据导入

利用 Navicat 导入向导，导入`Budding	Yeast_SNPs.txt` `saccharomyces_cerevisiae_R64-1-1_20110208.gff` 文件到 MySQL 数据库

其中，`saccharomyces_cerevisiae_R64-1-1_20110208.gff` 文件仅提取第 1，3，4，5 列为有效信息

![image-20220303104300359](report.assets/image-20220303104300359.png)

![image-20220303104355955](report.assets/image-20220303104355955.png)

## 创建实体类

`Information` 类，存储基因位置

```java
package com.zidongzh.pojo;

/**
 * @author ZidongZh
 * @date 2022/3/3
 */
public class Information {
    private String chromosomeId;
    private String type;
    private Integer startPos;
    private Integer endPos;

    /**
     * constructor
     *
     * @param chromosomeId 染色体号
     * @param type         类型 (基因，非基因)
     * @param startPos     起始位置
     * @param endPos       终止位置
     */
    public Information(
            String chromosomeId,
            String type,
            Integer startPos,
            Integer endPos) {
        this.chromosomeId = chromosomeId;
        this.type = type;
        this.startPos = startPos;
        this.endPos = endPos;
    }

    @Override
    public String toString() {
        return "Information{" +
                "chromosomeId='" + chromosomeId + '\'' +
                ", type='" + type + '\'' +
                ", startPos=" + startPos +
                ", endPos=" + endPos +
                '}';
    }

    // getter and setter


    public String getChromosomeId() {
        return chromosomeId;
    }

    public void setChromosomeId(String chromosomeId) {
        this.chromosomeId = chromosomeId;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    public Integer getStartPos() {
        return startPos;
    }

    public void setStartPos(Integer startPos) {
        this.startPos = startPos;
    }

    public Integer getEndPos() {
        return endPos;
    }

    public void setEndPos(Integer endPos) {
        this.endPos = endPos;
    }

}

```

`Mutation` 类，存储编译信息。

```java
package com.zidongzh.pojo;

/**
 * @author ZidongZh
 * @date 2022/3/3
 */
public class Mutation {
    private String chromosomeId;
    private Integer chromosomePos;
    private String type;

    /**
     * constructor
     *
     * @param chromosomeId  染色体号
     * @param chromosomePos 染色体位置
     * @param type          变异类型
     */
    public Mutation(
            String chromosomeId,
            Integer chromosomePos,
            String type) {
        this.chromosomeId = chromosomeId;
        this.chromosomePos = chromosomePos;
        this.type = type;
    }

    @Override
    public String toString() {
        return "Mutation{" +
                "chromosomeId='" + chromosomeId + '\'' +
                ", chromosomePos=" + chromosomePos +
                ", type='" + type + '\'' +
                '}';
    }

    // getter and setter

    public String getChromosomeId() {
        return chromosomeId;
    }

    public void setChromosomeId(String chromosomeId) {
        this.chromosomeId = chromosomeId;
    }

    public Integer getChromosomePos() {
        return chromosomePos;
    }

    public void setChromosomePos(Integer chromosomePos) {
        this.chromosomePos = chromosomePos;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }
}

```

### 数据处理

对 `saccharomyces_cerevisiae_R64-1-1_20110208` 数据中基因重叠起始位置的处理

```java
    /**
     * 合并重叠基因区间
     *
     * @param information 原始数据
     */
    void connect(List<Information> information) {
        int i = 0;
        int j = 1;
        Information previous = null;
        Information next = null;
        while (j < information.size()) {
            previous = information.get(i);
            next = information.get(j);
            if (previous.getEndPos() >= next.getStartPos() && previous.getEndPos() <= next.getEndPos()) {
                previous.setEndPos(next.getEndPos());
                information.remove(j);
                information.set(i, previous);
            } else {
                i++;
                j++;
            }
        }
    }
```

获取非基因区间

```java
    /**
     * @param genes       基因信息
     * @param chromosomes 染色体信息
     * @return 非基因区间
     */
    List<Information> getNonGenes(List<Information> genes,
                                  List<Information> chromosomes) {
        int pos = 0;

        List<Information> nonGenes = new ArrayList<>();
        Information nonGeneHead = new Information(chromosomes.get(0).getChromosomeId(), "nonGene", 1, genes.get(0).getStartPos() - 1);
        nonGenes.add(nonGeneHead);
//        System.out.println(nonGeneHead);
        for (int i = 0; i < chromosomes.size(); i++) {
//            System.out.println("-------------------------");
//            System.out.println(chromosomes.get(i));
//            System.out.println("-------------------------");
            for (int j = 0; j < genes.size(); j++) {
                if (genes.get(j).getChromosomeId().equals(chromosomes.get(i).getChromosomeId()) &&
                        genes.get(j + 1).getChromosomeId().equals(chromosomes.get(i).getChromosomeId())) {
                    Information nonGene = new Information(genes.get(j).getChromosomeId(), "nonGene", genes.get(j).getEndPos() + 1, genes.get(j + 1).getStartPos() - 1);
                    nonGenes.add(nonGene);
                    pos = j + 2;
//                    System.out.println(nonGene);
                }
            }
            if (null != genes.get(pos)){
                System.out.println(genes.get(pos));
                Information nonGeneHead1 = new Information(genes.get(pos).getChromosomeId(), "nonGene", 1, genes.get(pos).getStartPos() - 1);
                nonGenes.add(nonGeneHead1);
            }
        }
//        System.out.println(nonGenes);
        return nonGenes;
    }
```



# 实验过程



样本 个体 随机变量定义



# 实验结果



# 生物学意义



