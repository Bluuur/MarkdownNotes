# ChIP-seq 数据预处理

<center>生信 2001 张子栋 2020317210101</center>

[toc]

## 下载 DNA 测序数据

### PubMed 数据库中搜索数据文献

#### 选定研究物种

​	选定研究物种为线虫（$nematode,\ Caenorhabditis\ Elegans$）。

#### 在 PubMed 中检索文献

​	在 [PubMed (nih.gov)](https://pubmed.ncbi.nlm.nih.gov/) 中搜索关键字 `Caenorhabditis Elegans ChIP seq`. 并选定文献为 [The hypoxia response pathway promotes PEP carboxykinase and gluconeogenesis in C. elegans - PubMed (nih.gov)](https://pubmed.ncbi.nlm.nih.gov/36257965/)（Nat Commun. 2022 Oct 18;13(1):6168. DOI: [10.1038/s41467-022-33849-x](https://doi.org/10.1038/s41467-022-33849-x)）. 这篇文章研究的内容是在线虫中，缺氧应答通路如何通过激活 HIF-1 转录因子来调节 PEP 羧激酶和糖异生的基因表达和代谢流动，从而提高对氧化应激和缺氧应激的抵抗力。PEP 羧激酶是糖异生过程中的限速酶，可以将草酰乙酸转化为磷酸烯醇式丙酮酸。作者利用基因组编辑、转录组分析、代谢组分析和行为实验等方法来揭示 HIF-1 直接或间接调控的上百个基因的功能。这篇文章使用 ChIP-Seq 的目的是为了发现 HIF-1 直接调控的基因，并分析它们在缺氧应答通路中的功能。

#### 数据获取

​	文章中的 ChIP-seq 数据上传至 NIH/NCBI 数据库，登录号为 [GSE173333](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE173333)。SRA 数据库对应登录号为 [SRP316378 - SRA - NCBI (nih.gov)](https://www.ncbi.nlm.nih.gov/sra?term=SRP316378)，最终选择 `SRR14325856` 作为研究数据。

​	登录服务器后，使用以下命令下载数据：

```shell
wget https://trace.ncbi.nlm.nih.gov/Traces/sra-reads-be/fastq?acc=SRR14325856
```

## 数据预处理

### 使用 FastQC 分析数据

#### FastQC 简要说明

​	FastQC 是一个质量控制分析工具，用于检测高通量测序数据中的潜在问题。它提供了一系列的分析模块，可以帮助快速了解数据是否有任何需要注意的问题，以便进行进一步的分析。FastQC 可以处理 `fastq` 或 `bam` 格式的原始序列文件，并生成一个报告，总结分析结果。

​	FastQC 的报告是一个 HTML 文件，包含了各种分析模块的结果和图表。FastQC 的报告中，每个分析模块都有一个结果图和一个状态图标。状态图标表示该模块的结果是否正常（绿色）、需要注意（黄色）或有问题（红色）。

​	FastQC 有以下几个分析模块：

+ 基本统计：显示输入文件的名称、编码类型、总读数、读长和 GC 含量等信息。
+ 每碱基质量分布：显示每个位置的平均质量得分，以及上下四分位数的范围。
+ 每序列质量分布：显示每个序列的平均质量得分的频率分布，以及对应的合格率。
+ 每碱基序列内容：显示每个位置的 A、T、G 和 C 的比例，以及与理论值的偏差。
+ 每序列 GC 含量：显示每个序列的 GC 含量的频率分布，以及与整体 GC 含量的比较。
+ 每碱基 N 含量：显示每个位置包含 N（未知）碱基的比例。
+ 序列长度分布：显示不同长度序列出现的频率，以及平均长度和最大长度。
+ 序列重复度：显示不同重复次数序列出现的频率，以及总重复度和最大重复度。
+ 过表示 kmer 内容：显示在所有序列中过表示（出现次数超过预期）或者欠表示（出现次数低于预期）的 kmer（一般为 7 或 8 bp），以及它们在序列中出现的位置和比例。
+ 适配器内容：检测输入文件中是否包含常见适配器序列，并显示它们在不同位置出现的比例。

#### 具体步骤

